<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ATS Resume Scorer</title>

<!-- Tailwind -->
<script src="https://cdn.tailwindcss.com"></script>

<!-- Font Awesome -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>

<!-- PDF.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<style>
body { font-family: Inter, sans-serif; background:#f8fafc; }
</style>
</head>

<body class="min-h-screen bg-slate-100">

<div class="max-w-6xl mx-auto p-6">

<h1 class="text-3xl font-bold text-center mb-6">ATS Resume Checker</h1>

<!-- Inputs -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-6">

<!-- JD -->
<div class="bg-white p-4 rounded-xl shadow">
<h2 class="font-semibold mb-2">Job Description</h2>
<textarea id="jdInput" rows="10"
class="w-full border p-3 rounded"
placeholder="Paste job description..."></textarea>
</div>

<!-- Resume -->
<div class="bg-white p-4 rounded-xl shadow">
<div class="flex justify-between items-center mb-2">
<h2 class="font-semibold">Resume</h2>

<button onclick="document.getElementById('pdfUpload').click()"
class="text-sm text-blue-600">
<i class="fa fa-upload"></i> Upload PDF
</button>
</div>

<textarea id="resumeInput" rows="10"
class="w-full border p-3 rounded"
placeholder="Paste resume or upload PDF..."></textarea>

<p id="loadingText" class="text-sm text-blue-600 mt-2 hidden">
Reading PDFâ€¦ please wait
</p>

<input type="file" id="pdfUpload" accept="application/pdf"
class="hidden" onchange="loadPDF(event)"/>
</div>

</div>

<!-- Button -->
<div class="text-center mt-6">
<button id="analyzeBtn" onclick="analyzeResume()"
class="bg-blue-600 text-white px-6 py-3 rounded-full font-semibold disabled:opacity-50"
disabled>
Analyze Resume
</button>
</div>

<!-- Results -->
<div id="resultsSection" class="hidden mt-8 bg-white p-6 rounded-xl shadow">
<h2 class="text-xl font-bold mb-4">Results</h2>

<p><b>Score:</b> <span id="scoreText">0%</span></p>
<p><b>Matched Keywords:</b> <span id="matchedCount">0</span></p>
<p><b>Missing Keywords:</b> <span id="missingCount">0</span></p>

<h3 class="mt-4 font-semibold">Matched</h3>
<div id="matchedKeywordsList" class="flex flex-wrap gap-2 mt-2"></div>

<h3 class="mt-4 font-semibold">Missing</h3>
<div id="missingKeywordsList" class="flex flex-wrap gap-2 mt-2"></div>
</div>

</div>

<script>
/* ---------- FLAGS ---------- */
let resumeLoaded = false;

/* ---------- STOP WORDS ---------- */
const STOP_WORDS = new Set([
"a","the","and","to","of","in","for","with","on","at","by","from",
"experience","skills","knowledge","work","team","using"
]);

/* ---------- PDF LOAD ---------- */
async function loadPDF(event) {
const file = event.target.files[0];
if (!file) return;

resumeLoaded = false;
document.getElementById("loadingText").classList.remove("hidden");
document.getElementById("analyzeBtn").disabled = true;

const reader = new FileReader();
reader.onload = async function() {
const typedarray = new Uint8Array(this.result);
const pdf = await pdfjsLib.getDocument(typedarray).promise;

let text = "";
for (let i = 1; i <= pdf.numPages; i++) {
const page = await pdf.getPage(i);
const content = await page.getTextContent();
content.items.forEach(item => text += item.str + " ");
}

document.getElementById("resumeInput").value = text;
resumeLoaded = true;

document.getElementById("loadingText").classList.add("hidden");
document.getElementById("analyzeBtn").disabled = false;
};
reader.readAsArrayBuffer(file);
}

/* ---------- HELPERS ---------- */
function cleanText(text) {
return text.toLowerCase().replace(/[^\w\s]/g," ").replace(/\s+/g," ");
}

function extractKeywords(text) {
const words = cleanText(text).split(" ");
const freq = {};
words.forEach(w=>{
if(w.length>2 && !STOP_WORDS.has(w)){
freq[w]=(freq[w]||0)+1;
}
});
return Object.keys(freq).map(w=>({word:w,count:freq[w]}))
.sort((a,b)=>b.count-a.count);
}

/* ---------- MAIN ---------- */
function analyzeResume() {
const jd = document.getElementById("jdInput").value.trim();
const resume = document.getElementById("resumeInput").value.trim();

if (!jd || !resume) {
alert("Please paste Job Description and upload Resume");
return;
}

if (jd.length < 50 || resume.length < 50) {
alert("Text is too short to analyze");
return;
}

const jdKeys = extractKeywords(jd).slice(0,30);
const resumeSet = new Set(extractKeywords(resume).map(k=>k.word));

let matched=[], missing=[];
jdKeys.forEach(k=>{
resumeSet.has(k.word)?matched.push(k):missing.push(k);
});

const score = Math.round((matched.length/jdKeys.length)*100);

document.getElementById("resultsSection").classList.remove("hidden");
document.getElementById("scoreText").innerText = score+"%";
document.getElementById("matchedCount").innerText = matched.length;
document.getElementById("missingCount").innerText = missing.length;

renderList("matchedKeywordsList", matched, "green");
renderList("missingKeywordsList", missing, "red");
}

function renderList(id,list,color){
const el=document.getElementById(id);
el.innerHTML="";
list.forEach(k=>{
const span=document.createElement("span");
span.className=`px-3 py-1 rounded-full text-sm bg-${color}-100 text-${color}-800`;
span.innerText=k.word;
el.appendChild(span);
});
}
</script>

</body>
</html>
